<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nausheen Husain">

<title>Afghan refugees</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="afghan_refugees_files/libs/clipboard/clipboard.min.js"></script>
<script src="afghan_refugees_files/libs/quarto-html/quarto.js"></script>
<script src="afghan_refugees_files/libs/quarto-html/popper.min.js"></script>
<script src="afghan_refugees_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="afghan_refugees_files/libs/quarto-html/anchor.min.js"></script>
<link href="afghan_refugees_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="afghan_refugees_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="afghan_refugees_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="afghan_refugees_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="afghan_refugees_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#securing-our-refugee-microdata" id="toc-securing-our-refugee-microdata" class="nav-link" data-scroll-target="#securing-our-refugee-microdata"><span class="header-section-number">2</span> Securing our refugee microdata</a></li>
  <li><a href="#exploring-our-data-by-year" id="toc-exploring-our-data-by-year" class="nav-link" data-scroll-target="#exploring-our-data-by-year"><span class="header-section-number">3</span> Exploring our data by year</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="afghan_refugees.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="afghan_refugees.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Afghan refugees</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nausheen Husain </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>This is a living document in which I am doing analysis of available refugee and asylum data, specifically for those coming to the U.S. from Afghanistan. I will be using the R libraries tidyverse and ggplot2 to ask and answer basic questions about some datasets we currently have access to. The data will come from the following sources:</p>
<ul>
<li><a href="https://www.refugeeresettlementdata.com/data.html">Chris Parson’s refugee dataset</a>
<ul>
<li>This has already been converted from .dta to .csv using Pandas.</li>
</ul></li>
<li><a href="https://www.wrapsnet.org/admissions-and-arrivals/">Wrapsnet data</a></li>
<li><a href="https://www.unhcr.org/refugee-statistics/download/?url=uu9qRu">UNHCR refugee data</a></li>
<li>We may also have asylum data from <a href="https://trac.syr.edu/phptools/immigration/asyfile/">TRAC</a></li>
</ul>
<p>I will try to publish this analysis on <a href="https://quarto.org/docs/publishing/github-pages.html">Github Pages</a>, and it will be used for a reporting project on this same topic with Jazzmin Jiwa.</p>
<div class="cell">
<details>
<summary>Packages</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="securing-our-refugee-microdata" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="securing-our-refugee-microdata"><span class="header-section-number">2</span> Securing our refugee microdata</h2>
<p><strong>From Chris Parson’s data:</strong> The first thing I want to do is combine two separate datasets with refugee microdata, and narrow the data down to only show rows where the birth or citizenship country is ‘Afghanistan.’ (I did this separately in R.) The below dataframe includes both datasets from Parson’s data, where each row has ‘afghanistan’ for either the birth or citizenship country. It includes a column I added to indicate the current age of each refugee.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>af_ref <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"af_refugee_microdata.csv"</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">head</span>(af_ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    X city city_code county_fips state_fips  fips birth_country_name
1  14            243         043         06 06043        afghanistan
2  15            243         043         06 06043        afghanistan
3  16            243         043         06 06043        afghanistan
4  17            243         043         06 06043        afghanistan
5  18            243         043         06 06043        afghanistan
6 110           1000         001         06 06001        afghanistan
  citizenship_country_name citizenship_stable year birth_year    sex
1              afghanistan        afghanistan 1983       1958 female
2              afghanistan        afghanistan 1983       1959 female
3              afghanistan        afghanistan 1983       1962 female
4              afghanistan        afghanistan 1983       1950   male
5              afghanistan        afghanistan 1983       1936 female
6              afghanistan        afghanistan 1983       1977 female
  marital_status family_Status education english_reading english_writing
1        unknown       unknown   unknown     unknown (U)     unknown (U)
2        unknown       unknown   unknown     unknown (U)     unknown (U)
3        unknown       unknown   unknown     unknown (U)     unknown (U)
4        unknown       unknown   unknown     unknown (U)     unknown (U)
5        unknown       unknown   unknown     unknown (U)     unknown (U)
6        unknown       unknown   unknown     unknown (U)     unknown (U)
  english_speaking county10name longitude latitude id_merging current_age
1      unknown (U)     Mariposa -119.9621  37.4869      12408          65
2      unknown (U)     Mariposa -119.9621  37.4869      12408          64
3      unknown (U)     Mariposa -119.9621  37.4869      12408          61
4      unknown (U)     Mariposa -119.9621  37.4869      12408          73
5      unknown (U)     Mariposa -119.9621  37.4869      12408          87
6      unknown (U)                     NA       NA     999999          46</code></pre>
</div>
</div>
<p>This dataframe has 34791 rows, which means it looks at 34791 individual refugees.</p>
</section>
<section id="exploring-our-data-by-year" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="exploring-our-data-by-year"><span class="header-section-number">3</span> Exploring our data by year</h2>
<p>The most important question for this particular reporting project is, have incoming refugees from Afghanistan increased over the years, particularly after the U.S. invaded Afghanistan in 2001? Grouping the data by year looks like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>by_year <span class="ot">&lt;-</span> <span class="fu">group_by</span>(af_ref,year)</span>
<span id="cb4-2"><a href="#cb4-2"></a>by_year <span class="ot">&lt;-</span> <span class="fu">summarize</span>(by_year,<span class="at">refugees=</span><span class="fu">n</span>())</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">print</span>(by_year, <span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 2
    year refugees
   &lt;int&gt;    &lt;int&gt;
 1  1975       10
 2  1976       24
 3  1977       23
 4  1978       40
 5  1979       53
 6  1980      235
 7  1981     1757
 8  1982      379
 9  1983     2822
10  1984     2432
11  1985     2240
12  1986     2597
13  1987     2688
14  1988     2209
15  1989     1743
16  1990      198
17  1991     1193
18  1992     1749
19  1993      660
20  1994       31
21  1995       14
22  1996        9
23  1997       12
24  1998       88
25  1999      536
26  2000     1773
27  2001     2724
28  2002     2014
29  2003     1357
30  2004      807
31  2005      783
32  2006      626
33  2007      383
34  2008      580
35    NA        2</code></pre>
</div>
</div>
<p>Our most important finding from this view is that we don’t have any data beyond 2008. We also see that the years the U.S. saw the most incoming refugees were 1983 and 2001. Let’s see what this looks like:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(by_year, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>refugees))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="afghan_refugees_files/figure-html/fig-line-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Incoming refugees from Afghanistan by year, 1975-2008</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s add our PRM data, which goes from 2008 to 2023, and should give us a fuller picture of how incoming refugee numbers have fluctuated over time. [We should probably FOIA for pre-2008 data from PRM in order to be able to compare the numbers with Chris Parson’s microdata.]</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>af_ref_PRM <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"PRM_af_year.csv"</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb8-2"><a href="#cb8-2"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">select</span>(af_ref_PRM, year, fy_total)</span>
<span id="cb8-3"><a href="#cb8-3"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">filter</span>(PRM_by_year,year<span class="sc">&gt;</span><span class="dv">2008</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">arrange</span>(PRM_by_year,year)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">colnames</span>(PRM_by_year)[<span class="dv">2</span>]<span class="ot">=</span><span class="st">"refugees"</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>all_years <span class="ot">&lt;-</span> <span class="fu">rbind</span>(by_year, PRM_by_year)</span>
<span id="cb8-7"><a href="#cb8-7"></a>all_years <span class="ot">&lt;-</span> all_years[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">35</span>), ]</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="fu">print</span>(all_years,<span class="at">n=</span><span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49 × 2
    year refugees
   &lt;int&gt;    &lt;int&gt;
 1  1975       10
 2  1976       24
 3  1977       23
 4  1978       40
 5  1979       53
 6  1980      235
 7  1981     1757
 8  1982      379
 9  1983     2822
10  1984     2432
11  1985     2240
12  1986     2597
13  1987     2688
14  1988     2209
15  1989     1743
16  1990      198
17  1991     1193
18  1992     1749
19  1993      660
20  1994       31
21  1995       14
22  1996        9
23  1997       12
24  1998       88
25  1999      536
26  2000     1773
27  2001     2724
28  2002     2014
29  2003     1357
30  2004      807
31  2005      783
32  2006      626
33  2007      383
34  2008      580
35  2009      349
36  2010      515
37  2011      428
38  2012      481
39  2013      661
40  2014      753
41  2015      910
42  2016     2737
43  2017     1311
44  2018      806
45  2019     1198
46  2020      604
47  2021      872
48  2022     1618
49  2023     1985</code></pre>
</div>
</div>
<p>Some notes on this tibble: This combines two different datasets – one downloaded from the State Dept’s <a href="https://www.wrapsnet.org/admissions-and-arrivals/">Bureau of Population, Refugees, and Migration</a> and one from <a href="https://www.refugeeresettlementdata.com/">Chris Parson’s microdata</a> on refugee resettlement. Both of these datasets were narrowed to just total refugees by year from Afghanistan and then combined. Chris Parson’s data is from 1975 to 2008, and the PRM data is 2009 to 2023. <span style="color:purple">FOIA: Ideally, we will be able to request PRM data from before 2008 in order to be able to compare Parson’s data to the State Dept’s.</span> We removed one row from Parson’s data in which year was N/A and refugees was 2.</p>
<p>Let’s see what it looks like if we create a line chart out of our new, more complete dataset.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">ggplot</span>(all_years, <span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>refugees,<span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of incoming refugees from Afghanistan"</span>, <span class="at">title =</span> <span class="st">"1983, 2001 and 2016 saw record highs in incoming Afghan refugees"</span>)<span class="sc">+</span><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1990</span>, <span class="at">y=</span><span class="dv">2950</span>, <span class="at">label=</span><span class="st">"Highest amount of incoming Afghan refugees in 1983"</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-line2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="afghan_refugees_files/figure-html/fig-line2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Incoming refugees from Afghanistan by year, 1975-2023</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-line2">Figure&nbsp;2</a> tells us some notable information for our reporting: the highest amounts of incoming refugees are now arriving in 1983, 2016 and 2001. We should think through what was happening around these years to create a sharp increase in incoming refugees – there are some obvious answers here. I think it’d also be useful to compare these numbers to numbers from Iraq.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="an">title:</span><span class="co"> "Afghan refugees"</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="an">author:</span><span class="co"> "Nausheen Husain"</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="an">format:</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">  html:</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">    theme: default</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">    code-fold: true</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">    code-tools: true</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">  pdf:</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">    geometry: </span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">      - top=30mm</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">      - left=30mm</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">  docx: default</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="an">project:</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">  type: website</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">  output-dir: docs</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">---</span></span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="fu">## Introduction</span></span>
<span id="cb11-23"><a href="#cb11-23"></a></span>
<span id="cb11-24"><a href="#cb11-24"></a>This is a living document in which I am doing analysis of available refugee and asylum data, specifically for those coming to the U.S. from Afghanistan. I will be using the R libraries tidyverse and ggplot2 to ask and answer basic questions about some datasets we currently have access to. The data will come from the following sources:</span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Chris Parson's refugee dataset</span><span class="co">](https://www.refugeeresettlementdata.com/data.html)</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="ss">    + </span>This has already been converted from .dta to .csv using Pandas.</span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="ss">* </span><span class="co">[</span><span class="ot">Wrapsnet data</span><span class="co">](https://www.wrapsnet.org/admissions-and-arrivals/)</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="ss">* </span><span class="co">[</span><span class="ot">UNHCR refugee data</span><span class="co">](https://www.unhcr.org/refugee-statistics/download/?url=uu9qRu)</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="ss">* </span>We may also have asylum data from <span class="co">[</span><span class="ot">TRAC</span><span class="co">](https://trac.syr.edu/phptools/immigration/asyfile/)</span></span>
<span id="cb11-31"><a href="#cb11-31"></a></span>
<span id="cb11-32"><a href="#cb11-32"></a>I will try to publish this analysis on <span class="co">[</span><span class="ot">Github Pages</span><span class="co">](https://quarto.org/docs/publishing/github-pages.html)</span>, and it will be used for a reporting project on this same topic with Jazzmin Jiwa.</span>
<span id="cb11-33"><a href="#cb11-33"></a></span>
<span id="cb11-34"><a href="#cb11-34"></a></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="in">```{r}</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#| label: load-pkgs</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#| code-summary: "Packages"</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#| message: false</span></span>
<span id="cb11-41"><a href="#cb11-41"></a></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="in">```</span></span>
<span id="cb11-45"><a href="#cb11-45"></a></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="fu">## Securing our refugee microdata</span></span>
<span id="cb11-47"><a href="#cb11-47"></a></span>
<span id="cb11-48"><a href="#cb11-48"></a>**From Chris Parson's data:** The first thing I want to do is combine two separate datasets with refugee microdata, and narrow the data down to only show rows where the birth or citizenship country is 'Afghanistan.' (I did this separately in R.) The below dataframe includes both datasets from Parson's data, where each row has 'afghanistan' for either the birth or citizenship country. It includes a column I added to indicate the current age of each refugee.</span>
<span id="cb11-49"><a href="#cb11-49"></a></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="in">```{r}</span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="co">#| label: data-head</span></span>
<span id="cb11-54"><a href="#cb11-54"></a></span>
<span id="cb11-55"><a href="#cb11-55"></a>af_ref <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"af_refugee_microdata.csv"</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="fu">head</span>(af_ref)</span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="in">```</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>This dataframe has <span class="in">`r nrow(af_ref)`</span> rows, which means it looks at <span class="in">`r nrow(af_ref)`</span> individual refugees.</span>
<span id="cb11-59"><a href="#cb11-59"></a></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="fu">## Exploring our data by year</span></span>
<span id="cb11-61"><a href="#cb11-61"></a></span>
<span id="cb11-62"><a href="#cb11-62"></a>The most important question for this particular reporting project is, have incoming refugees from Afghanistan increased over the years, particularly after the U.S. invaded Afghanistan in 2001? Grouping the data by year looks like this:</span>
<span id="cb11-63"><a href="#cb11-63"></a></span>
<span id="cb11-66"><a href="#cb11-66"></a><span class="in">```{r}</span></span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="co">#| label: by-year</span></span>
<span id="cb11-68"><a href="#cb11-68"></a></span>
<span id="cb11-69"><a href="#cb11-69"></a>by_year <span class="ot">&lt;-</span> <span class="fu">group_by</span>(af_ref,year)</span>
<span id="cb11-70"><a href="#cb11-70"></a>by_year <span class="ot">&lt;-</span> <span class="fu">summarize</span>(by_year,<span class="at">refugees=</span><span class="fu">n</span>())</span>
<span id="cb11-71"><a href="#cb11-71"></a><span class="fu">print</span>(by_year, <span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="in">```</span></span>
<span id="cb11-73"><a href="#cb11-73"></a></span>
<span id="cb11-74"><a href="#cb11-74"></a>Our most important finding from this view is that we don't have any data beyond 2008. We also see that the years the U.S. saw the most incoming refugees were 1983 and 2001. Let's see what this looks like:</span>
<span id="cb11-75"><a href="#cb11-75"></a></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="in">```{r}</span></span>
<span id="cb11-79"><a href="#cb11-79"></a><span class="co">#| label: fig-line</span></span>
<span id="cb11-80"><a href="#cb11-80"></a><span class="co">#| fig-cap: "Incoming refugees from Afghanistan by year, 1975-2008"</span></span>
<span id="cb11-81"><a href="#cb11-81"></a></span>
<span id="cb11-82"><a href="#cb11-82"></a><span class="fu">ggplot</span>(by_year, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>refugees))<span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb11-83"><a href="#cb11-83"></a></span>
<span id="cb11-84"><a href="#cb11-84"></a><span class="in">```</span></span>
<span id="cb11-85"><a href="#cb11-85"></a></span>
<span id="cb11-86"><a href="#cb11-86"></a>Let's add our PRM data, which goes from 2008 to 2023, and should give us a fuller picture of how incoming refugee numbers have fluctuated over time. <span class="co">[</span><span class="ot">We should probably FOIA for pre-2008 data from PRM in order to be able to compare the numbers with Chris Parson's microdata.</span><span class="co">]</span></span>
<span id="cb11-87"><a href="#cb11-87"></a></span>
<span id="cb11-90"><a href="#cb11-90"></a><span class="in">```{r}</span></span>
<span id="cb11-91"><a href="#cb11-91"></a><span class="co">#| label: append-PRM</span></span>
<span id="cb11-92"><a href="#cb11-92"></a></span>
<span id="cb11-93"><a href="#cb11-93"></a>af_ref_PRM <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"PRM_af_year.csv"</span>,<span class="at">stringsAsFactors=</span>F)</span>
<span id="cb11-94"><a href="#cb11-94"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">select</span>(af_ref_PRM, year, fy_total)</span>
<span id="cb11-95"><a href="#cb11-95"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">filter</span>(PRM_by_year,year<span class="sc">&gt;</span><span class="dv">2008</span>)</span>
<span id="cb11-96"><a href="#cb11-96"></a>PRM_by_year <span class="ot">&lt;-</span> <span class="fu">arrange</span>(PRM_by_year,year)</span>
<span id="cb11-97"><a href="#cb11-97"></a><span class="fu">colnames</span>(PRM_by_year)[<span class="dv">2</span>]<span class="ot">=</span><span class="st">"refugees"</span></span>
<span id="cb11-98"><a href="#cb11-98"></a>all_years <span class="ot">&lt;-</span> <span class="fu">rbind</span>(by_year, PRM_by_year)</span>
<span id="cb11-99"><a href="#cb11-99"></a>all_years <span class="ot">&lt;-</span> all_years[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">35</span>), ]</span>
<span id="cb11-100"><a href="#cb11-100"></a><span class="fu">print</span>(all_years,<span class="at">n=</span><span class="cn">Inf</span>)</span>
<span id="cb11-101"><a href="#cb11-101"></a><span class="in">```</span></span>
<span id="cb11-102"><a href="#cb11-102"></a></span>
<span id="cb11-103"><a href="#cb11-103"></a>Some notes on this tibble: This combines two different datasets -- one downloaded from the State Dept's <span class="co">[</span><span class="ot">Bureau of Population, Refugees, and Migration</span><span class="co">](https://www.wrapsnet.org/admissions-and-arrivals/)</span> and one from <span class="co">[</span><span class="ot">Chris Parson's microdata</span><span class="co">](https://www.refugeeresettlementdata.com/)</span> on refugee resettlement. Both of these datasets were narrowed to just total refugees by year from Afghanistan and then combined. Chris Parson's data is from 1975 to 2008, and the PRM data is 2009 to 2023. <span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:purple"</span><span class="kw">&gt;</span>FOIA: Ideally, we will be able to request PRM data from before 2008 in order to be able to compare Parson's data to the State Dept's.<span class="kw">&lt;/span&gt;</span> We removed one row from Parson's data in which year was N/A and refugees was 2.</span>
<span id="cb11-104"><a href="#cb11-104"></a></span>
<span id="cb11-105"><a href="#cb11-105"></a>Let's see what it looks like if we create a line chart out of our new, more complete dataset.</span>
<span id="cb11-106"><a href="#cb11-106"></a></span>
<span id="cb11-109"><a href="#cb11-109"></a><span class="in">```{r}</span></span>
<span id="cb11-110"><a href="#cb11-110"></a><span class="co">#| label: fig-line2</span></span>
<span id="cb11-111"><a href="#cb11-111"></a><span class="co">#| fig-cap: "Incoming refugees from Afghanistan by year, 1975-2023"</span></span>
<span id="cb11-112"><a href="#cb11-112"></a></span>
<span id="cb11-113"><a href="#cb11-113"></a><span class="fu">ggplot</span>(all_years, <span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>refugees,<span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of incoming refugees from Afghanistan"</span>, <span class="at">title =</span> <span class="st">"1983, 2001 and 2016 saw record highs in incoming Afghan refugees"</span>)<span class="sc">+</span><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1990</span>, <span class="at">y=</span><span class="dv">2950</span>, <span class="at">label=</span><span class="st">"Highest amount of incoming Afghan refugees in 1983"</span>, <span class="at">color=</span><span class="st">"red"</span>)</span>
<span id="cb11-114"><a href="#cb11-114"></a><span class="in">```</span></span>
<span id="cb11-115"><a href="#cb11-115"></a></span>
<span id="cb11-116"><a href="#cb11-116"></a>@fig-line2 tells us some notable information for our reporting: the highest amounts of incoming refugees are now arriving in 1983, 2016 and 2001. We should think through what was happening around these years to create a sharp increase in incoming refugees -- there are some obvious answers here. I think it'd also be useful to compare these numbers to numbers from Iraq.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>